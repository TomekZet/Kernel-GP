#!/usr/bin/python
#-*- coding: utf-8 -*-
'''
Created on Sep 15, 2012

@author: tomek
'''
import argparse
import string
import os


def group(data, headersDict, column_nr, prefix='', sort_column_nr=None, cols_to_divide=[]):
    groups = {}
    
    if sort_column_nr:
        data = sorted(data, key=lambda line: string.split(line)[sort_column_nr])
    for i, line in enumerate(data):
       row = string.split(line)
       for col in cols_to_divide:
           col_nr = headersDict.get(col, None)
           if col_nr and col_nr < len(row):
               v = float(row[col_nr])
               v /= 100
               row[col_nr] = str(v)             
       groups.setdefault('-'.join((prefix, row[column_nr])), []).append(' '.join(row))
    return groups



def multi_group(data, headersDict, columns, sort_column, cols_to_divide=[]):
    
    sort_column_nr = headersDict.get(sort_column, None)
    
    groups = {'result':data[1:]}
    for column in columns:
        column_nr = headersDict.get(column)
        result = {}        
        for value, g in groups.items():
            result.update(group(g, headersDict, column_nr, "%s.%s" % (value, column), sort_column_nr, cols_to_divide))
        groups = result
    return result, headers
           
 

if __name__ == '__main__':
   
    
   parser = argparse.ArgumentParser(description='Splits datasets by grouping it according to data in column given as argument. Each group is written to a different file.')
   parser.add_argument('-i', '--input', help='Input file path')
   parser.add_argument('-c', '--columns', nargs="+", help='Number of column to group by', type=int)
   parser.add_argument('-n', '--names', nargs="+", help='Name of column to group by (assumes that column names are unique', type=str, default='generations')
   parser.add_argument('-s', '--sort', help='Name of column to sort by', type=str, default=None)
   parser.add_argument('-d', '--divide', help='Name of column(s) to to divide by 100', type=str, nargs="+", default=[])

   args = parser.parse_args()
   
   with open(args.input, 'r') as f:
       data = f.readlines()
   
   headers = string.split(data[0])
   headersDict = dict([(h,i) for i, h in enumerate(headers)])
   
   groups, headers = multi_group(data, headersDict, args.names, args.sort, cols_to_divide=args.divide)
   
   input_file_name = args.input
   input_file_name = os.path.split(input_file_name)[1]

   
   for name, group in groups.iteritems():
      with open("grouped/"+input_file_name+'.'+name+'.dat', 'w') as out:
          out.write(' '.join(headers)+'\n')
          for i, line in enumerate(group):
               out.write(' '.join([str(i)] + string.split(line)[1:])+'\n')
   
   
#   c = args.column
#   headers = ''
#   groups = {}
#   with open(args.input, 'r') as f:
#       headers = string.split(f.readline())
#       headersDict = dict([(h,i) for i, h in enumerate(headers)])
#       if args.name:
#           c = headersDict.get(args.name, c)
#       columns = len(headers)
#       for line in f:
#          line = string.split(line)
#          #Some rows may be shorter due to smaller number of acuuracy and time measurments
#          line[-3:-3] = ['NaN' for i in range(columns-len(line))]
#          groups.setdefault(line[c], []).append(line)
#              
#   input_file_name = args.input
#   input_file_name = os.path.split(args.input)[1]
#   for val, group in groups.items():
#       with open("grouped/"+input_file_name+'.'+headers[c]+'-'+val+'.dat', 'w') as out:
#           out.write(' '.join(headers)+'\n')
#           for i, line in enumerate(group):
#               out.write(str(i)+' '+' '.join(line[1:])+'\n')
       
   
   
       
def test():
    
    data = [
    "N dataset population_size generations cross_validation cv_folds epsilon cache shrinking cost fitness_0_0 accuracy_0_0 fitness_0_1 accuracy_0_1 fitness_0_2 accuracy_0_2 fitness_0_3 accuracy_0_3 fitness_0_4 accuracy_0_4 fitness_0_5 accuracy_0_5 fitness_0_6 accuracy_0_6 fitness_0_7 accuracy_0_7 fitness_1_0 accuracy_1_0 fitness_1_1 accuracy_1_1 fitness_1_2 accuracy_1_2 fitness_1_3 accuracy_1_3 fitness_1_4 accuracy_1_4 fitness_1_5 accuracy_1_5 fitness_1_6 accuracy_1_6 fitness_1_7 accuracy_1_7 fitness_2_0 accuracy_2_0 fitness_2_1 accuracy_2_1 fitness_2_2 accuracy_2_2 fitness_2_3 accuracy_2_3 fitness_2_4 accuracy_2_4 fitness_2_5 accuracy_2_5 fitness_2_6 accuracy_2_6 fitness_2_7 accuracy_2_7 fitness_3_0 accuracy_3_0 fitness_3_1 accuracy_3_1 fitness_3_2 accuracy_3_2 fitness_3_3 accuracy_3_3 fitness_3_4 accuracy_3_4 fitness_3_5 accuracy_3_5 fitness_3_6 accuracy_3_6 fitness_3_7 accuracy_3_7 fitness_4_0 accuracy_4_0 fitness_4_1 accuracy_4_1 fitness_4_2 accuracy_4_2 fitness_4_3 accuracy_4_3 fitness_4_4 accuracy_4_4 fitness_4_5 accuracy_4_5 fitness_4_6 accuracy_4_6 fitness_4_7 accuracy_4_7 mean_fitness mean_accuracy time",
    "1 heart.scale 1 8 False 10 0.100000 100 0 0.300000 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.9104477763175964 74.6268656716418 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.8208954930305481 85.07462686567165 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.7910447716712952 86.56716417910447 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 89.55223880597015 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.850746214389801 85.07462686567165 0.844776 84.179104 0.686372",
    "2 heart.scale 21 8 False 10 0.100000 100 0 0.300000 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.8955223560333252 86.56716417910447 0.8955223560333252 86.56716417910447 0.8955223560333252 86.56716417910447 0.8955223560333252 86.56716417910447 0.8955223560333252 86.56716417910447 0.9104477763175964 88.05970149253731 0.9104477763175964 88.05970149253731 0.9104477763175964 88.05970149253731 0.8208954930305481 91.04477611940298 0.8208954930305481 91.04477611940298 0.8208954930305481 91.04477611940298 0.8358209133148193 80.59701492537313 0.8358209133148193 80.59701492537313 0.8358209133148193 80.59701492537313 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.895522 83.880597 2.804354",
    "3 heart.scale 41 8 False 10 0.100000 100 0 0.300000 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.8955223560333252 86.56716417910447 0.8955223560333252 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.8208954930305481 91.04477611940298 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.850746214389801 82.08955223880598 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.895522 83.582090 3.630936",
    "4 heart.scale 61 8 False 10 0.100000 100 0 0.300000 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.8208954930305481 91.04477611940298 0.8208954930305481 91.04477611940298 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.895522 83.582090 9.164952",
    "5 heart.scale 81 8 False 10 0.100000 100 0 0.300000 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9701492786407471 76.11940298507463 0.9701492786407471 76.11940298507463 0.9701492786407471 76.11940298507463 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.8208954930305481 91.04477611940298 0.8358209133148193 85.07462686567165 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.850746214389801 82.08955223880598 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.898507 83.283582 23.775549",
    "6 heart.scale 101 8 False 10 0.100000 100 0 0.300000 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9552238583564758 77.61194029850746 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.9104477763175964 86.56716417910447 0.8208954930305481 91.04477611940298 0.8358209133148193 82.08955223880598 0.8358209133148193 82.08955223880598 0.850746214389801 80.59701492537313 0.850746214389801 80.59701492537313 0.850746214389801 80.59701492537313 0.850746214389801 80.59701492537313 0.850746214389801 80.59701492537313 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.8955223560333252 83.5820895522388 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.865671694278717 88.05970149253731 0.895522 83.283582 32.643607",
    "7 breast.scale 1 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.227595",
    "8 breast.scale 21 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.229993",
    "9 breast.scale 41 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.234046",
    "10 breast.scale 61 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.234905",
    "11 breast.scale 81 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.247734",
    "12 breast.scale 101 8 False 10 0.100000 100 0 0.300000 nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan 0.244779",
    "13 iris.scale 1 8 False 10 0.100000 100 0 0.300000 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.6486486196517944 75.67567567567568 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.129730 15.135135 0.364968",
    "14 iris.scale 21 8 False 10 0.100000 100 0 0.300000 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.194595 19.459459 1.303339",
    "15 iris.scale 41 8 False 10 0.100000 100 0 0.300000 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.194595 19.459459 1.544923",
    "16 iris.scale 61 8 False 10 0.100000 100 0 0.300000 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.194595 19.459459 1.757416",
    "17 iris.scale 81 8 False 10 0.100000 100 0 0.300000 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.194595 19.459459 2.573491",
    "18 iris.scale 101 8 False 10 0.100000 100 0 0.300000 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.9729729890823364 97.2972972972973 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.194595 19.459459 5.333692",
    "19 dna.scale 1 8 False 10 0.100000 100 0 0.300000 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.9479999542236328 92.60000000000001 0.940400 94.520000 50.437971",
    "20 dna.scale 21 8 False 10 0.100000 100 0 0.300000 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9479999542236328 93.8 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.942000 94.240000 1078.463036",
    "21 dna.scale 41 8 False 10 0.100000 100 0 0.300000 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9359999895095825 96.0 0.9359999895095825 96.0 0.9359999895095825 96.0 0.937999963760376 94.39999999999999 0.937999963760376 94.39999999999999 0.9440000057220459 94.39999999999999 0.9460000395774841 94.8 0.9479999542236328 94.6 0.9479999542236328 94.6 0.9479999542236328 94.6 0.9479999542236328 94.6 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.9559999704360962 91.2 0.944800 94.160000 2506.368387",
    "22 dna.scale 61 8 False 10 0.100000 100 0 0.300000 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.949999988079071 93.8 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 95.19999999999999 0.9340000152587891 96.6 0.9340000152587891 96.6 0.9359999895095825 96.0 0.9359999895095825 96.0 0.937999963760376 96.0 0.9420000314712524 96.6 0.9420000314712524 96.6 0.9420000314712524 96.6"
    ]
    
    result = multi_group(data, ('dataset', 'population_size'))
#    import pdb;pdb.set_trace()
    
    result = {
        "dataset":{
           "breast.scale":{
               "kernel":{
                   "linear":[  
                        [0, "breast.scale", "linear", "accuracy", 1, 1, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.941885, 0.956012, 96.078432, 0.955882, 0.911765, 0.944382, 0.956012, 94.607842, 0.938160, 0.877791, 0.938914, 0.956012, 96.568626, 0.962554, 0.925163, 0.948030, 0.958944, 98.039216, 0.978397, 0.956793, 0.959635, 0.960704, 96.176471, 0.957309, 0.915197, 0.946569, 5.807708],
                        [1, "breast.scale", "linear", "accuracy", 1, 2, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.942866, 0.956012, 95.588237, 0.950183, 0.900424, 0.942691, 0.956012, 94.607842, 0.938160, 0.877791, 0.938740, 0.956012, 96.568626, 0.962554, 0.925163, 0.947879, 0.958944, 98.039216, 0.978397, 0.956793, 0.956491, 0.960704, 96.078432, 0.956169, 0.912929, 0.945733, 5.807708],
                        [2, "breast.scale", "linear", "accuracy", 1, 3, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.941646, 0.956012, 96.078432, 0.955882, 0.911765, 0.945808, 0.956012, 94.607842, 0.938160, 0.877791, 0.938797, 0.956012, 96.568626, 0.962554, 0.925163, 0.945292, 0.958944, 98.529410, 0.983850, 0.967757, 0.959398, 0.960704, 96.274509, 0.958399, 0.917390, 0.946188, 5.807708]
                    ],
                   "poly":[
                       [0, "breast.scale", "poly", "accuracy", 1, 1, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.942015, 0.970675, 97.058821, 0.967150, 0.934531, 0.952483, 0.976540, 95.098037, 0.944853, 0.889706, 0.938800, 0.967742, 96.568626, 0.962554, 0.925163, 0.954420, 0.964809, 98.039216, 0.978535, 0.957296, 0.956965, 0.971261, 96.568626, 0.962033, 0.924563, 0.948937, 4.832372],
                       [1, "breast.scale", "poly", "accuracy", 1, 2, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.942311, 0.970675, 97.058821, 0.967150, 0.934531, 0.951688, 0.976540, 95.098037, 0.944853, 0.889706, 0.938104, 0.967742, 96.568626, 0.962554, 0.925163, 0.954393, 0.964809, 98.039216, 0.978535, 0.957296, 0.956350, 0.971261, 96.568626, 0.962033, 0.924563, 0.948569, 4.832372],
                       [2, "breast.scale", "poly", "accuracy", 1, 3, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.941502, 0.970675, 97.058821, 0.967150, 0.934531, 0.951787, 0.976540, 95.098037, 0.944853, 0.889706, 0.938078, 0.967742, 96.568626, 0.962554, 0.925163, 0.955171, 0.964809, 98.039216, 0.978535, 0.957296, 0.957917, 0.971261, 96.568626, 0.962033, 0.924563, 0.948891, 4.832372],
                    ]
                }
            },
           "heart.scale":{
               "kernel":{
                   "linear":[  
                        [0, "heart.scale", "linear", "accuracy", 1, 1, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.941885, 0.956012, 96.078432, 0.955882, 0.911765, 0.944382, 0.956012, 94.607842, 0.938160, 0.877791, 0.938914, 0.956012, 96.568626, 0.962554, 0.925163, 0.948030, 0.958944, 98.039216, 0.978397, 0.956793, 0.959635, 0.960704, 96.176471, 0.957309, 0.915197, 0.946569, 5.807708],
                        [1, "heart.scale", "linear", "accuracy", 1, 2, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.942866, 0.956012, 95.588237, 0.950183, 0.900424, 0.942691, 0.956012, 94.607842, 0.938160, 0.877791, 0.938740, 0.956012, 96.568626, 0.962554, 0.925163, 0.947879, 0.958944, 98.039216, 0.978397, 0.956793, 0.956491, 0.960704, 96.078432, 0.956169, 0.912929, 0.945733, 5.807708],
                        [2, "heart.scale", "linear", "accuracy", 1, 3, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 95.588237, 0.951550, 0.904474, 0.941646, 0.956012, 96.078432, 0.955882, 0.911765, 0.945808, 0.956012, 94.607842, 0.938160, 0.877791, 0.938797, 0.956012, 96.568626, 0.962554, 0.925163, 0.945292, 0.958944, 98.529410, 0.983850, 0.967757, 0.959398, 0.960704, 96.274509, 0.958399, 0.917390, 0.946188, 5.807708]
                    ],
                   "poly":[
                       [0, "heart.scale", "poly", "accuracy", 1, 1, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.942015, 0.970675, 97.058821, 0.967150, 0.934531, 0.952483, 0.976540, 95.098037, 0.944853, 0.889706, 0.938800, 0.967742, 96.568626, 0.962554, 0.925163, 0.954420, 0.964809, 98.039216, 0.978535, 0.957296, 0.956965, 0.971261, 96.568626, 0.962033, 0.924563, 0.948937, 4.832372],
                       [1, "heart.scale", "poly", "accuracy", 1, 2, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.942311, 0.970675, 97.058821, 0.967150, 0.934531, 0.951688, 0.976540, 95.098037, 0.944853, 0.889706, 0.938104, 0.967742, 96.568626, 0.962554, 0.925163, 0.954393, 0.964809, 98.039216, 0.978535, 0.957296, 0.956350, 0.971261, 96.568626, 0.962033, 0.924563, 0.948569, 4.832372],
                       [2, "heart.scale", "poly", "accuracy", 1, 3, "False", 10, 0.100000, 100, 0, 0.300000, 0.976540, 96.078432, 0.957071, 0.916120, 0.941502, 0.970675, 97.058821, 0.967150, 0.934531, 0.951787, 0.976540, 95.098037, 0.944853, 0.889706, 0.938078, 0.967742, 96.568626, 0.962554, 0.925163, 0.955171, 0.964809, 98.039216, 0.978535, 0.957296, 0.957917, 0.971261, 96.568626, 0.962033, 0.924563, 0.948891, 4.832372],
                    ]
                }
            }
        }
    }           
    
